<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:restaurant.ViewModels"
             x:Class="restaurant.Views.PaiementPage"
             Title="Paiement">
    
    <Grid RowDefinitions="Auto,*,Auto" Padding="15">
        <!-- En-tête -->
        <StackLayout Grid.Row="0" Spacing="10" Margin="0,0,0,20">
            <Label Text="Finaliser votre commande" 
                   FontSize="24" 
                   FontAttributes="Bold" 
                   HorizontalOptions="Center"/>
            <Label Text="{Binding CommandeNumero, StringFormat='Commande #{0}'}"
                   FontSize="16"
                   HorizontalOptions="Center"/>
        </StackLayout>
        
        <!-- Contenu principal -->
        <ScrollView Grid.Row="1">
            <StackLayout Spacing="20">
                <!-- Résumé de la commande -->
                <Frame BorderColor="LightGray" Padding="15" CornerRadius="10">
                    <StackLayout Spacing="10">
                        <Label Text="Résumé de la commande" 
                               FontSize="18" 
                               FontAttributes="Bold"/>
                        
                        <BoxView HeightRequest="1" 
                                 BackgroundColor="LightGray" 
                                 Margin="0,5"/>
                        
                        <Grid ColumnDefinitions="*,Auto">
                            <Label Text="Total à payer:" FontAttributes="Bold"/>
                            <Label Grid.Column="1" 
                                   Text="{Binding MontantTotal, StringFormat='{0:C}'}" 
                                   FontAttributes="Bold"
                                   FontSize="18"/>
                        </Grid>
                    </StackLayout>
                </Frame>
                
                <!-- Méthode de paiement -->
                <Frame BorderColor="LightGray" Padding="15" CornerRadius="10">
                    <StackLayout Spacing="10">
                        <Label Text="Méthode de paiement" 
                               FontSize="18" 
                               FontAttributes="Bold"/>
                        
                        <BoxView HeightRequest="1" 
                                 BackgroundColor="LightGray" 
                                 Margin="0,5"/>
                        
                        <RadioButton Content="Carte bancaire" 
                                     IsChecked="{Binding IsCarteBancaireSelected}"
                                     GroupName="MethodePaiement"/>
                        
                        <RadioButton Content="Espèces" 
                                     IsChecked="{Binding IsEspecesSelected}"
                                     GroupName="MethodePaiement"/>
                        
                        <RadioButton Content="Paiement à la livraison" 
                                     IsChecked="{Binding IsPaiementLivraisonSelected}"
                                     GroupName="MethodePaiement"/>
                    </StackLayout>
                </Frame>
                
                <!-- Informations carte bancaire (conditionnellement visible) -->
                <Frame BorderColor="LightGray" 
                       Padding="15" 
                       CornerRadius="10" 
                       IsVisible="{Binding IsCarteBancaireSelected}">
                    <StackLayout Spacing="15">
                        <Label Text="Informations de carte" 
                               FontSize="18" 
                               FontAttributes="Bold"/>
                        
                        <BoxView HeightRequest="1" 
                                 BackgroundColor="LightGray" 
                                 Margin="0,5"/>
                        
                        <Entry Placeholder="Numéro de carte"
                               Text="{Binding NumeroCarte}"
                               Keyboard="Numeric"
                               MaxLength="16"/>
                               
                        <Grid ColumnDefinitions="*,*">
                            <Entry Grid.Column="0" 
                                   Placeholder="MM/AA" 
                                   Text="{Binding DateExpiration}"
                                   MaxLength="5"/>
                                   
                            <Entry Grid.Column="1" 
                                   Placeholder="CVC" 
                                   Text="{Binding CodeCVC}"
                                   Keyboard="Numeric"
                                   MaxLength="3"/>
                        </Grid>
                        
                        <Entry Placeholder="Nom sur la carte"
                               Text="{Binding NomCarte}"/>
                    </StackLayout>
                </Frame>
                
                <!-- Notes supplémentaires -->
                <Frame BorderColor="LightGray" Padding="15" CornerRadius="10">
                    <StackLayout Spacing="10">
                        <Label Text="Notes supplémentaires" 
                               FontSize="18" 
                               FontAttributes="Bold"/>
                        
                        <BoxView HeightRequest="1" 
                                 BackgroundColor="LightGray" 
                                 Margin="0,5"/>
                        
                        <Editor Placeholder="Ajoutez des instructions spéciales pour votre commande..."
                                Text="{Binding Notes}"
                                HeightRequest="100"/>
                    </StackLayout>
                </Frame>
            </StackLayout>
        </ScrollView>
        
        <!-- Bouton de paiement -->
        <Button Grid.Row="2" 
                Text="Confirmer le paiement" 
                BackgroundColor="#4CAF50"
                TextColor="White"
                FontAttributes="Bold"
                HeightRequest="50"
                CornerRadius="25"
                Margin="0,20,0,0"
                Command="{Binding ConfirmerPaiementCommand}"/>
    </Grid>
</ContentPage>